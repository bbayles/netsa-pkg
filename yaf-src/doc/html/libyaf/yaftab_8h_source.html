<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YAF: yaftab.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Tutorials</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_615759f7aa2b23f9d732a2fd184cb668.html">yaf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">yaftab.h</div></div>
</div><!--header-->
<div class="contents">
<a href="yaftab_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002"></a><span class="lineno">    2</span><span class="comment">** yaftab.h</span></div>
<div class="line"><a id="l00003"></a><span class="lineno">    3</span><span class="comment">** YAF Active Flow Table</span></div>
<div class="line"><a id="l00004"></a><span class="lineno">    4</span><span class="comment">**</span></div>
<div class="line"><a id="l00005"></a><span class="lineno">    5</span><span class="comment">** ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00006"></a><span class="lineno">    6</span><span class="comment">** Copyright (C) 2006-2023 Carnegie Mellon University. All Rights Reserved.</span></div>
<div class="line"><a id="l00007"></a><span class="lineno">    7</span><span class="comment">** ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00008"></a><span class="lineno">    8</span><span class="comment">** Authors: Brian Trammell</span></div>
<div class="line"><a id="l00009"></a><span class="lineno">    9</span><span class="comment">** ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00010"></a><span class="lineno">   10</span><span class="comment">** @OPENSOURCE_HEADER_START@</span></div>
<div class="line"><a id="l00011"></a><span class="lineno">   11</span><span class="comment">** Use of the YAF system and related source code is subject to the terms</span></div>
<div class="line"><a id="l00012"></a><span class="lineno">   12</span><span class="comment">** of the following licenses:</span></div>
<div class="line"><a id="l00013"></a><span class="lineno">   13</span><span class="comment">**</span></div>
<div class="line"><a id="l00014"></a><span class="lineno">   14</span><span class="comment">** GNU General Public License (GPL) Rights pursuant to Version 2, June 1991</span></div>
<div class="line"><a id="l00015"></a><span class="lineno">   15</span><span class="comment">** Government Purpose License Rights (GPLR) pursuant to DFARS 252.227.7013</span></div>
<div class="line"><a id="l00016"></a><span class="lineno">   16</span><span class="comment">**</span></div>
<div class="line"><a id="l00017"></a><span class="lineno">   17</span><span class="comment">** NO WARRANTY</span></div>
<div class="line"><a id="l00018"></a><span class="lineno">   18</span><span class="comment">**</span></div>
<div class="line"><a id="l00019"></a><span class="lineno">   19</span><span class="comment">** ANY INFORMATION, MATERIALS, SERVICES, INTELLECTUAL PROPERTY OR OTHER</span></div>
<div class="line"><a id="l00020"></a><span class="lineno">   20</span><span class="comment">** PROPERTY OR RIGHTS GRANTED OR PROVIDED BY CARNEGIE MELLON UNIVERSITY</span></div>
<div class="line"><a id="l00021"></a><span class="lineno">   21</span><span class="comment">** PURSUANT TO THIS LICENSE (HEREINAFTER THE &quot;DELIVERABLES&quot;) ARE ON AN</span></div>
<div class="line"><a id="l00022"></a><span class="lineno">   22</span><span class="comment">** &quot;AS-IS&quot; BASIS. CARNEGIE MELLON UNIVERSITY MAKES NO WARRANTIES OF ANY</span></div>
<div class="line"><a id="l00023"></a><span class="lineno">   23</span><span class="comment">** KIND, EITHER EXPRESS OR IMPLIED AS TO ANY MATTER INCLUDING, BUT NOT</span></div>
<div class="line"><a id="l00024"></a><span class="lineno">   24</span><span class="comment">** LIMITED TO, WARRANTY OF FITNESS FOR A PARTICULAR PURPOSE,</span></div>
<div class="line"><a id="l00025"></a><span class="lineno">   25</span><span class="comment">** MERCHANTABILITY, INFORMATIONAL CONTENT, NONINFRINGEMENT, OR ERROR-FREE</span></div>
<div class="line"><a id="l00026"></a><span class="lineno">   26</span><span class="comment">** OPERATION. CARNEGIE MELLON UNIVERSITY SHALL NOT BE LIABLE FOR INDIRECT,</span></div>
<div class="line"><a id="l00027"></a><span class="lineno">   27</span><span class="comment">** SPECIAL OR CONSEQUENTIAL DAMAGES, SUCH AS LOSS OF PROFITS OR INABILITY</span></div>
<div class="line"><a id="l00028"></a><span class="lineno">   28</span><span class="comment">** TO USE SAID INTELLECTUAL PROPERTY, UNDER THIS LICENSE, REGARDLESS OF</span></div>
<div class="line"><a id="l00029"></a><span class="lineno">   29</span><span class="comment">** WHETHER SUCH PARTY WAS AWARE OF THE POSSIBILITY OF SUCH DAMAGES.</span></div>
<div class="line"><a id="l00030"></a><span class="lineno">   30</span><span class="comment">** LICENSEE AGREES THAT IT WILL NOT MAKE ANY WARRANTY ON BEHALF OF</span></div>
<div class="line"><a id="l00031"></a><span class="lineno">   31</span><span class="comment">** CARNEGIE MELLON UNIVERSITY, EXPRESS OR IMPLIED, TO ANY PERSON</span></div>
<div class="line"><a id="l00032"></a><span class="lineno">   32</span><span class="comment">** CONCERNING THE APPLICATION OF OR THE RESULTS TO BE OBTAINED WITH THE</span></div>
<div class="line"><a id="l00033"></a><span class="lineno">   33</span><span class="comment">** DELIVERABLES UNDER THIS LICENSE.</span></div>
<div class="line"><a id="l00034"></a><span class="lineno">   34</span><span class="comment">**</span></div>
<div class="line"><a id="l00035"></a><span class="lineno">   35</span><span class="comment">** Licensee hereby agrees to defend, indemnify, and hold harmless Carnegie</span></div>
<div class="line"><a id="l00036"></a><span class="lineno">   36</span><span class="comment">** Mellon University, its trustees, officers, employees, and agents from</span></div>
<div class="line"><a id="l00037"></a><span class="lineno">   37</span><span class="comment">** all claims or demands made against them (and any related losses,</span></div>
<div class="line"><a id="l00038"></a><span class="lineno">   38</span><span class="comment">** expenses, or attorney&#39;s fees) arising out of, or relating to Licensee&#39;s</span></div>
<div class="line"><a id="l00039"></a><span class="lineno">   39</span><span class="comment">** and/or its sub licensees&#39; negligent use or willful misuse of or</span></div>
<div class="line"><a id="l00040"></a><span class="lineno">   40</span><span class="comment">** negligent conduct or willful misconduct regarding the Software,</span></div>
<div class="line"><a id="l00041"></a><span class="lineno">   41</span><span class="comment">** facilities, or other rights or assistance granted by Carnegie Mellon</span></div>
<div class="line"><a id="l00042"></a><span class="lineno">   42</span><span class="comment">** University under this License, including, but not limited to, any</span></div>
<div class="line"><a id="l00043"></a><span class="lineno">   43</span><span class="comment">** claims of product liability, personal injury, death, damage to</span></div>
<div class="line"><a id="l00044"></a><span class="lineno">   44</span><span class="comment">** property, or violation of any laws or regulations.</span></div>
<div class="line"><a id="l00045"></a><span class="lineno">   45</span><span class="comment">**</span></div>
<div class="line"><a id="l00046"></a><span class="lineno">   46</span><span class="comment">** Carnegie Mellon University Software Engineering Institute authored</span></div>
<div class="line"><a id="l00047"></a><span class="lineno">   47</span><span class="comment">** documents are sponsored by the U.S. Department of Defense under</span></div>
<div class="line"><a id="l00048"></a><span class="lineno">   48</span><span class="comment">** Contract FA8721-05-C-0003. Carnegie Mellon University retains</span></div>
<div class="line"><a id="l00049"></a><span class="lineno">   49</span><span class="comment">** copyrights in all material produced under this contract. The U.S.</span></div>
<div class="line"><a id="l00050"></a><span class="lineno">   50</span><span class="comment">** Government retains a non-exclusive, royalty-free license to publish or</span></div>
<div class="line"><a id="l00051"></a><span class="lineno">   51</span><span class="comment">** reproduce these documents, or allow others to do so, for U.S.</span></div>
<div class="line"><a id="l00052"></a><span class="lineno">   52</span><span class="comment">** Government purposes only pursuant to the copyright license under the</span></div>
<div class="line"><a id="l00053"></a><span class="lineno">   53</span><span class="comment">** contract clause at 252.227.7013.</span></div>
<div class="line"><a id="l00054"></a><span class="lineno">   54</span><span class="comment">**</span></div>
<div class="line"><a id="l00055"></a><span class="lineno">   55</span><span class="comment">** @OPENSOURCE_HEADER_END@</span></div>
<div class="line"><a id="l00056"></a><span class="lineno">   56</span><span class="comment">** ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00057"></a><span class="lineno">   57</span><span class="comment">*/</span></div>
<div class="line"><a id="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059"></a><span class="lineno">   59</span><span class="comment">/*</span></div>
<div class="line"><a id="l00060"></a><span class="lineno">   60</span><span class="comment"> * This is the documentation for the _old_ yaftab.h; it is no longer current,</span></div>
<div class="line"><a id="l00061"></a><span class="lineno">   61</span><span class="comment"> * and should not be read by anyone.</span></div>
<div class="line"><a id="l00062"></a><span class="lineno">   62</span><span class="comment"> *</span></div>
<div class="line"><a id="l00063"></a><span class="lineno">   63</span><span class="comment"> * Flow generation interface for YAF. This facility works by maintaining a</span></div>
<div class="line"><a id="l00064"></a><span class="lineno">   64</span><span class="comment"> * current flow table. Packets may be added to the active flows within this</span></div>
<div class="line"><a id="l00065"></a><span class="lineno">   65</span><span class="comment"> * table using the yfFlowPkt() call. Completed flows may be written to an</span></div>
<div class="line"><a id="l00066"></a><span class="lineno">   66</span><span class="comment"> * IPFIX message buffer using yfFlowFlush().</span></div>
<div class="line"><a id="l00067"></a><span class="lineno">   67</span><span class="comment"> *</span></div>
<div class="line"><a id="l00068"></a><span class="lineno">   68</span><span class="comment"> * The flow table is configured by a number of global variables.</span></div>
<div class="line"><a id="l00069"></a><span class="lineno">   69</span><span class="comment"> *</span></div>
<div class="line"><a id="l00070"></a><span class="lineno">   70</span><span class="comment"> * &lt;tt&gt;yaf_idle&lt;/tt&gt; sets</span></div>
<div class="line"><a id="l00071"></a><span class="lineno">   71</span><span class="comment"> * the idle timeout in seconds. A flow that receives no packets for the idle</span></div>
<div class="line"><a id="l00072"></a><span class="lineno">   72</span><span class="comment"> * timeout is assumed to be complete. The idle timeout is set to 300 seconds</span></div>
<div class="line"><a id="l00073"></a><span class="lineno">   73</span><span class="comment"> * (five minutes) by default.</span></div>
<div class="line"><a id="l00074"></a><span class="lineno">   74</span><span class="comment"> *</span></div>
<div class="line"><a id="l00075"></a><span class="lineno">   75</span><span class="comment"> * &lt;tt&gt;yaf_active&lt;/tt&gt; sets the active timeout in seconds.</span></div>
<div class="line"><a id="l00076"></a><span class="lineno">   76</span><span class="comment"> * The maximum duration of a flow is the active timeout; additional packets</span></div>
<div class="line"><a id="l00077"></a><span class="lineno">   77</span><span class="comment"> * for the same flow will be counted as part of a new flow. The active timeout</span></div>
<div class="line"><a id="l00078"></a><span class="lineno">   78</span><span class="comment"> * is set to 1800 seconds (half an hour) by default.</span></div>
<div class="line"><a id="l00079"></a><span class="lineno">   79</span><span class="comment"> *</span></div>
<div class="line"><a id="l00080"></a><span class="lineno">   80</span><span class="comment"> * &lt;tt&gt;yaf_flowlim&lt;/tt&gt; sets the maximum size of the flow table; flows</span></div>
<div class="line"><a id="l00081"></a><span class="lineno">   81</span><span class="comment"> * exceeding</span></div>
<div class="line"><a id="l00082"></a><span class="lineno">   82</span><span class="comment"> * this limit will be expired in least-recent order, as if they were idle. The</span></div>
<div class="line"><a id="l00083"></a><span class="lineno">   83</span><span class="comment"> * flow limit defaults to zero, for no limit. Use this global to limit resource</span></div>
<div class="line"><a id="l00084"></a><span class="lineno">   84</span><span class="comment"> * usage by the flow table.</span></div>
<div class="line"><a id="l00085"></a><span class="lineno">   85</span><span class="comment"> *</span></div>
<div class="line"><a id="l00086"></a><span class="lineno">   86</span><span class="comment"> * &lt;tt&gt;yaf_paylen&lt;/tt&gt; sets the number of bytes of payload to capture from the</span></div>
<div class="line"><a id="l00087"></a><span class="lineno">   87</span><span class="comment"> * start of each flow. The payload length defaults to zero, which disables</span></div>
<div class="line"><a id="l00088"></a><span class="lineno">   88</span><span class="comment"> * payload capture.</span></div>
<div class="line"><a id="l00089"></a><span class="lineno">   89</span><span class="comment"> *</span></div>
<div class="line"><a id="l00090"></a><span class="lineno">   90</span><span class="comment"> * &lt;tt&gt;yaf_uniflow&lt;/tt&gt;, if TRUE, exports flows in uniflow mode, using the</span></div>
<div class="line"><a id="l00091"></a><span class="lineno">   91</span><span class="comment"> * record adjacency export method described in section 3 of</span></div>
<div class="line"><a id="l00092"></a><span class="lineno">   92</span><span class="comment"> * draft-ietf-ipfix-biflow. Defaults to FALSE.</span></div>
<div class="line"><a id="l00093"></a><span class="lineno">   93</span><span class="comment"> *</span></div>
<div class="line"><a id="l00094"></a><span class="lineno">   94</span><span class="comment"> * &lt;tt&gt;yaf_macmode&lt;/tt&gt;, if TRUE, exports layer 2 information with each flow;</span></div>
<div class="line"><a id="l00095"></a><span class="lineno">   95</span><span class="comment"> * presently this is limited to VLAN tags but may be expanded to include the</span></div>
<div class="line"><a id="l00096"></a><span class="lineno">   96</span><span class="comment"> * MPLS stack and MAC addresses in the future. Defaults to FALSE.</span></div>
<div class="line"><a id="l00097"></a><span class="lineno">   97</span><span class="comment"> *</span></div>
<div class="line"><a id="l00098"></a><span class="lineno">   98</span><span class="comment"> * &lt;tt&gt;yaf_silkmode&lt;/tt&gt;, if TRUE, enables SiLK compatibility mode. In this</span></div>
<div class="line"><a id="l00099"></a><span class="lineno">   99</span><span class="comment"> * mode, totalOctetCount and reverseTotalOctetCount are clamped to 32 bits.</span></div>
<div class="line"><a id="l00100"></a><span class="lineno">  100</span><span class="comment"> * Any packet that would cause either of these counters to overflow 32 bits</span></div>
<div class="line"><a id="l00101"></a><span class="lineno">  101</span><span class="comment"> * will force an active timeout. The high-order bit of the flowEndReason IE</span></div>
<div class="line"><a id="l00102"></a><span class="lineno">  102</span><span class="comment"> * is set on any flow created on a counter overflow, as above, or on an active</span></div>
<div class="line"><a id="l00103"></a><span class="lineno">  103</span><span class="comment"> * timeout. Defaults to FALSE.</span></div>
<div class="line"><a id="l00104"></a><span class="lineno">  104</span><span class="comment"> *</span></div>
<div class="line"><a id="l00105"></a><span class="lineno">  105</span><span class="comment"> * &lt;tt&gt;yaf_reqtype&lt;/tt&gt; limits the flow table to collecting IPv4 or IPv6 flows</span></div>
<div class="line"><a id="l00106"></a><span class="lineno">  106</span><span class="comment"> * only. Set to YF_TYPE_IPv4 for IPv4 flows only, YF_TYPE_IPv6 for IPv6 flows</span></div>
<div class="line"><a id="l00107"></a><span class="lineno">  107</span><span class="comment"> * only, or YF_TYPE_IPANY (the default) to collect both IPv4 and IPv6 flows.</span></div>
<div class="line"><a id="l00108"></a><span class="lineno">  108</span><span class="comment"> *</span></div>
<div class="line"><a id="l00109"></a><span class="lineno">  109</span><span class="comment"> * This facility is used by YAF to assemble packets into flows.</span></div>
<div class="line"><a id="l00110"></a><span class="lineno">  110</span><span class="comment"> */</span></div>
<div class="line"><a id="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00120"></a><span class="lineno">  120</span><span class="preprocessor">#ifndef _YAF_TAB_H_</span></div>
<div class="line"><a id="l00121"></a><span class="lineno">  121</span><span class="preprocessor">#define _YAF_TAB_H_</span></div>
<div class="line"><a id="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123"></a><span class="lineno">  123</span><span class="preprocessor">#include &lt;yaf/autoinc.h&gt;</span></div>
<div class="line"><a id="l00124"></a><span class="lineno">  124</span><span class="preprocessor">#include &lt;<a class="code" href="yafcore_8h.html">yaf/yafcore.h</a>&gt;</span></div>
<div class="line"><a id="l00125"></a><span class="lineno">  125</span><span class="preprocessor">#include &lt;yaf/decode.h&gt;</span></div>
<div class="line"><a id="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128"></a><span class="lineno">  128</span><span class="keyword">struct </span>yfFlowTab_st;</div>
<div class="line"><a id="l00133"></a><span class="lineno"><a class="line" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">  133</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span>yfFlowTab_st <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>;</div>
<div class="line"><a id="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00223"></a><span class="lineno">  223</span><a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a> *</div>
<div class="line"><a id="l00224"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a6e7658086967b7337d41b792e05e14dd">  224</a></span><a class="code hl_function" href="yaftab_8h.html#a6e7658086967b7337d41b792e05e14dd">yfFlowTabAlloc</a>(</div>
<div class="line"><a id="l00225"></a><span class="lineno">  225</span>    uint64_t   idle_ms,</div>
<div class="line"><a id="l00226"></a><span class="lineno">  226</span>    uint64_t   active_ms,</div>
<div class="line"><a id="l00227"></a><span class="lineno">  227</span>    uint32_t   max_flows,</div>
<div class="line"><a id="l00228"></a><span class="lineno">  228</span>    uint32_t   max_payload,</div>
<div class="line"><a id="l00229"></a><span class="lineno">  229</span>    gboolean   uniflow,</div>
<div class="line"><a id="l00230"></a><span class="lineno">  230</span>    gboolean   silkmode,</div>
<div class="line"><a id="l00231"></a><span class="lineno">  231</span>    gboolean   macmode,</div>
<div class="line"><a id="l00232"></a><span class="lineno">  232</span>    gboolean   applabelmode,</div>
<div class="line"><a id="l00233"></a><span class="lineno">  233</span>    gboolean   entropymode,</div>
<div class="line"><a id="l00234"></a><span class="lineno">  234</span>    gboolean   fingerprintmode,</div>
<div class="line"><a id="l00235"></a><span class="lineno">  235</span>    gboolean   fpExportMode,</div>
<div class="line"><a id="l00236"></a><span class="lineno">  236</span>    gboolean   udp_max_payload,</div>
<div class="line"><a id="l00237"></a><span class="lineno">  237</span>    uint16_t   udp_uniflow_port,</div>
<div class="line"><a id="l00238"></a><span class="lineno">  238</span>    <span class="keywordtype">char</span>      *pcap_dir,</div>
<div class="line"><a id="l00239"></a><span class="lineno">  239</span>    <span class="keywordtype">char</span>      *pcap_meta_file,</div>
<div class="line"><a id="l00240"></a><span class="lineno">  240</span>    uint64_t   max_pcap,</div>
<div class="line"><a id="l00241"></a><span class="lineno">  241</span>    gboolean   pcap_per_flow,</div>
<div class="line"><a id="l00242"></a><span class="lineno">  242</span>    gboolean   force_read_all,</div>
<div class="line"><a id="l00243"></a><span class="lineno">  243</span>    gboolean   stats_mode,</div>
<div class="line"><a id="l00244"></a><span class="lineno">  244</span>    gboolean   index_pcap,</div>
<div class="line"><a id="l00245"></a><span class="lineno">  245</span>    gboolean   no_vlan_in_key,</div>
<div class="line"><a id="l00246"></a><span class="lineno">  246</span>    gboolean   ndpi,</div>
<div class="line"><a id="l00247"></a><span class="lineno">  247</span>    <span class="keywordtype">char</span>      *ndpi_proto_file,</div>
<div class="line"><a id="l00248"></a><span class="lineno">  248</span>    <span class="keywordtype">char</span>      *hash,</div>
<div class="line"><a id="l00249"></a><span class="lineno">  249</span>    <span class="keywordtype">char</span>      *stime,</div>
<div class="line"><a id="l00250"></a><span class="lineno">  250</span>    <span class="keywordtype">void</span>     **hfctx);</div>
<div class="line"><a id="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00259"></a><span class="lineno">  259</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00260"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a561a2425c34f20c77c9237ca6e9812d4">  260</a></span><a class="code hl_function" href="yaftab_8h.html#a561a2425c34f20c77c9237ca6e9812d4">yfFlowTabFree</a>(</div>
<div class="line"><a id="l00261"></a><span class="lineno">  261</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab);</div>
<div class="line"><a id="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00270"></a><span class="lineno">  270</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00271"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a416a4a18ac082b8d90c3f303b2d48329">  271</a></span><a class="code hl_function" href="yaftab_8h.html#a416a4a18ac082b8d90c3f303b2d48329">yfUpdateRollingPcapFile</a>(</div>
<div class="line"><a id="l00272"></a><span class="lineno">  272</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab,</div>
<div class="line"><a id="l00273"></a><span class="lineno">  273</span>    <span class="keywordtype">char</span>         *new_file_name);</div>
<div class="line"><a id="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00286"></a><span class="lineno">  286</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00287"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a8c9736e80ac4b9e1f99c9eeaf6f51bef">  287</a></span><a class="code hl_function" href="yaftab_8h.html#a8c9736e80ac4b9e1f99c9eeaf6f51bef">yfGetFlowTabStats</a>(</div>
<div class="line"><a id="l00288"></a><span class="lineno">  288</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab,</div>
<div class="line"><a id="l00289"></a><span class="lineno">  289</span>    uint64_t     *packets,</div>
<div class="line"><a id="l00290"></a><span class="lineno">  290</span>    uint64_t     *flows,</div>
<div class="line"><a id="l00291"></a><span class="lineno">  291</span>    uint64_t     *rej_pkts,</div>
<div class="line"><a id="l00292"></a><span class="lineno">  292</span>    uint32_t     *peak,</div>
<div class="line"><a id="l00293"></a><span class="lineno">  293</span>    uint32_t     *flush);</div>
<div class="line"><a id="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00306"></a><span class="lineno">  306</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00307"></a><span class="lineno"><a class="line" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64">  307</a></span><a class="code hl_function" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64">yfFlowPBuf</a>(</div>
<div class="line"><a id="l00308"></a><span class="lineno">  308</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab,</div>
<div class="line"><a id="l00309"></a><span class="lineno">  309</span>    <span class="keywordtype">size_t</span>        pbuflen,</div>
<div class="line"><a id="l00310"></a><span class="lineno">  310</span>    <a class="code hl_struct" href="structyf_p_buf__st.html">yfPBuf_t</a>     *pbuf);</div>
<div class="line"><a id="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00325"></a><span class="lineno">  325</span>gboolean</div>
<div class="line"><a id="l00326"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a6a423cb1a664ab1bffc3c5a87f184215">  326</a></span><a class="code hl_function" href="yaftab_8h.html#a6a423cb1a664ab1bffc3c5a87f184215">yfFlowTabFlush</a>(</div>
<div class="line"><a id="l00327"></a><span class="lineno">  327</span>    <span class="keywordtype">void</span>      *yfContext,</div>
<div class="line"><a id="l00328"></a><span class="lineno">  328</span>    gboolean   close,</div>
<div class="line"><a id="l00329"></a><span class="lineno">  329</span>    GError   **err);</div>
<div class="line"><a id="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00337"></a><span class="lineno">  337</span>uint64_t</div>
<div class="line"><a id="l00338"></a><span class="lineno"><a class="line" href="yaftab_8h.html#a1a53e42d3ae005b47da77a6e4a6695e0">  338</a></span><a class="code hl_function" href="yaftab_8h.html#a1a53e42d3ae005b47da77a6e4a6695e0">yfFlowTabCurrentTime</a>(</div>
<div class="line"><a id="l00339"></a><span class="lineno">  339</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab);</div>
<div class="line"><a id="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00349"></a><span class="lineno">  349</span>uint64_t</div>
<div class="line"><a id="l00350"></a><span class="lineno"><a class="line" href="yaftab_8h.html#acbb808b2cd98fa85bfc95c5b5515d2ae">  350</a></span><a class="code hl_function" href="yaftab_8h.html#acbb808b2cd98fa85bfc95c5b5515d2ae">yfFlowDumpStats</a>(</div>
<div class="line"><a id="l00351"></a><span class="lineno">  351</span>    <a class="code hl_typedef" href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a>  *flowtab,</div>
<div class="line"><a id="l00352"></a><span class="lineno">  352</span>    GTimer       *timer);</div>
<div class="line"><a id="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354"></a><span class="lineno">  354</span><span class="preprocessor">#endif </span><span class="comment">/* ifndef _YAF_TAB_H_ */</span><span class="preprocessor"></span></div>
<div class="ttc" id="astructyf_p_buf__st_html"><div class="ttname"><a href="structyf_p_buf__st.html">yfPBuf_st</a></div><div class="ttdoc">Full packet information structure.</div><div class="ttdef"><b>Definition:</b> decode.h:150</div></div>
<div class="ttc" id="ayafcore_8h_html"><div class="ttname"><a href="yafcore_8h.html">yafcore.h</a></div><div class="ttdoc">YAF Core Library.</div></div>
<div class="ttc" id="ayaftab_8h_html_a1a53e42d3ae005b47da77a6e4a6695e0"><div class="ttname"><a href="yaftab_8h.html#a1a53e42d3ae005b47da77a6e4a6695e0">yfFlowTabCurrentTime</a></div><div class="ttdeci">uint64_t yfFlowTabCurrentTime(yfFlowTab_t *flowtab)</div><div class="ttdoc">Get the current packet clock from a flow table.</div></div>
<div class="ttc" id="ayaftab_8h_html_a416a4a18ac082b8d90c3f303b2d48329"><div class="ttname"><a href="yaftab_8h.html#a416a4a18ac082b8d90c3f303b2d48329">yfUpdateRollingPcapFile</a></div><div class="ttdeci">void yfUpdateRollingPcapFile(yfFlowTab_t *flowtab, char *new_file_name)</div><div class="ttdoc">Update the Pcap Filename in the Flowtab for pcap meta data output.</div></div>
<div class="ttc" id="ayaftab_8h_html_a561a2425c34f20c77c9237ca6e9812d4"><div class="ttname"><a href="yaftab_8h.html#a561a2425c34f20c77c9237ca6e9812d4">yfFlowTabFree</a></div><div class="ttdeci">void yfFlowTabFree(yfFlowTab_t *flowtab)</div><div class="ttdoc">Free a previously allocated flow table.</div></div>
<div class="ttc" id="ayaftab_8h_html_a6a423cb1a664ab1bffc3c5a87f184215"><div class="ttname"><a href="yaftab_8h.html#a6a423cb1a664ab1bffc3c5a87f184215">yfFlowTabFlush</a></div><div class="ttdeci">gboolean yfFlowTabFlush(void *yfContext, gboolean close, GError **err)</div><div class="ttdoc">Flush closed flows in the given flow table to the given IPFIX Message Buffer.</div></div>
<div class="ttc" id="ayaftab_8h_html_a6e7658086967b7337d41b792e05e14dd"><div class="ttname"><a href="yaftab_8h.html#a6e7658086967b7337d41b792e05e14dd">yfFlowTabAlloc</a></div><div class="ttdeci">yfFlowTab_t * yfFlowTabAlloc(uint64_t idle_ms, uint64_t active_ms, uint32_t max_flows, uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean macmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port, char *pcap_dir, char *pcap_meta_file, uint64_t max_pcap, gboolean pcap_per_flow, gboolean force_read_all, gboolean stats_mode, gboolean index_pcap, gboolean no_vlan_in_key, gboolean ndpi, char *ndpi_proto_file, char *hash, char *stime, void **hfctx)</div><div class="ttdoc">yfFlowTabAlloc</div></div>
<div class="ttc" id="ayaftab_8h_html_a8c9736e80ac4b9e1f99c9eeaf6f51bef"><div class="ttname"><a href="yaftab_8h.html#a8c9736e80ac4b9e1f99c9eeaf6f51bef">yfGetFlowTabStats</a></div><div class="ttdeci">void yfGetFlowTabStats(yfFlowTab_t *flowtab, uint64_t *packets, uint64_t *flows, uint64_t *rej_pkts, uint32_t *peak, uint32_t *flush)</div><div class="ttdoc">yfGetFlowTabStats Get Flow Table Stats for Export</div></div>
<div class="ttc" id="ayaftab_8h_html_ab37f151a4c4f8428eaf11655ec54be64"><div class="ttname"><a href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64">yfFlowPBuf</a></div><div class="ttdeci">void yfFlowPBuf(yfFlowTab_t *flowtab, size_t pbuflen, yfPBuf_t *pbuf)</div><div class="ttdoc">Add a decoded packet buffer to a given flow table.</div></div>
<div class="ttc" id="ayaftab_8h_html_acbb808b2cd98fa85bfc95c5b5515d2ae"><div class="ttname"><a href="yaftab_8h.html#acbb808b2cd98fa85bfc95c5b5515d2ae">yfFlowDumpStats</a></div><div class="ttdeci">uint64_t yfFlowDumpStats(yfFlowTab_t *flowtab, GTimer *timer)</div><div class="ttdoc">Print flow table statistics to the log.</div></div>
<div class="ttc" id="ayaftab_8h_html_af996afca1a47dc95ab0f00253b774256"><div class="ttname"><a href="yaftab_8h.html#af996afca1a47dc95ab0f00253b774256">yfFlowTab_t</a></div><div class="ttdeci">struct yfFlowTab_st yfFlowTab_t</div><div class="ttdoc">A flow table.</div><div class="ttdef"><b>Definition:</b> yaftab.h:133</div></div>
</div><!-- fragment --></div><!-- contents -->
</body>
</html>
