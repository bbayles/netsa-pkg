<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
    Copyright (C) 2006-2023 Carnegie Mellon University
    See license information in LICENSE.txt.
-->
<!--
    @DISTRIBUTION_STATEMENT_BEGIN@
    YAF 2.15.0
    Copyright 2023 Carnegie Mellon University.
    NO WARRANTY. THIS CARNEGIE MELLON UNIVERSITY AND SOFTWARE ENGINEERING
    INSTITUTE MATERIAL IS FURNISHED ON AN "AS-IS" BASIS. CARNEGIE MELLON
    UNIVERSITY MAKES NO WARRANTIES OF ANY KIND, EITHER EXPRESSED OR IMPLIED,
    AS TO ANY MATTER INCLUDING, BUT NOT LIMITED TO, WARRANTY OF FITNESS FOR
    PURPOSE OR MERCHANTABILITY, EXCLUSIVITY, OR RESULTS OBTAINED FROM USE OF
    THE MATERIAL. CARNEGIE MELLON UNIVERSITY DOES NOT MAKE ANY WARRANTY OF
    ANY KIND WITH RESPECT TO FREEDOM FROM PATENT, TRADEMARK, OR COPYRIGHT
    INFRINGEMENT.
    Licensed under a GNU GPL 2.0-style license, please see LICENSE.txt or
    contact permission@sei.cmu.edu for full terms.
    [DISTRIBUTION STATEMENT A] This material has been approved for public
    release and unlimited distribution.  Please see Copyright notice for
    non-US Government use and distribution.
    GOVERNMENT PURPOSE RIGHTS - Software and Software Documentation
    Contract No.: FA8702-15-D-0002
    Contractor Name: Carnegie Mellon University
    Contractor Address: 4500 Fifth Avenue, Pittsburgh, PA 15213
    The Government's rights to use, modify, reproduce, release, perform,
    display, or disclose this software are restricted by paragraph (b)(2) of
    the Rights in Noncommercial Computer Software and Noncommercial Computer
    Software Documentation clause contained in the above identified
    contract. No restrictions apply after the expiration date shown
    above. Any reproduction of the software or portions thereof marked with
    this legend must also reproduce the markings.
    This Software includes and/or makes use of Third-Party Software each
    subject to its own license.
    DM23-2313
    @DISTRIBUTION_STATEMENT_END@
-->
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YAF: yafhooks.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Tutorials</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a5045e33371518ba116c1c14c2c2323b.html">yaf-2.15.0</a></li><li class="navelem"><a class="el" href="dir_ae8f2f998ff3bb5ff480803759e9725b.html">include</a></li><li class="navelem"><a class="el" href="dir_361f5664376d4a94a340c76a4ce1e7ee.html">yaf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">yafhooks.h</div></div>
</div><!--header-->
<div class="contents">
<a href="yafhooks_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002"></a><span class="lineno">    2</span><span class="comment"> *  Copyright 2007-2023 Carnegie Mellon University</span></div>
<div class="line"><a id="l00003"></a><span class="lineno">    3</span><span class="comment"> *  See license information in LICENSE.txt.</span></div>
<div class="line"><a id="l00004"></a><span class="lineno">    4</span><span class="comment"> */</span></div>
<div class="line"><a id="l00005"></a><span class="lineno">    5</span><span class="comment">/*</span></div>
<div class="line"><a id="l00006"></a><span class="lineno">    6</span><span class="comment"> *  yafhooks.h</span></div>
<div class="line"><a id="l00007"></a><span class="lineno">    7</span><span class="comment"> *  YAF Active Flow Table Plugin Interface</span></div>
<div class="line"><a id="l00008"></a><span class="lineno">    8</span><span class="comment"> *</span></div>
<div class="line"><a id="l00009"></a><span class="lineno">    9</span><span class="comment"> *  ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00010"></a><span class="lineno">   10</span><span class="comment"> *  Authors: Brian Trammell</span></div>
<div class="line"><a id="l00011"></a><span class="lineno">   11</span><span class="comment"> *  ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00012"></a><span class="lineno">   12</span><span class="comment"> *  @DISTRIBUTION_STATEMENT_BEGIN@</span></div>
<div class="line"><a id="l00013"></a><span class="lineno">   13</span><span class="comment"> *  YAF 2.15.0</span></div>
<div class="line"><a id="l00014"></a><span class="lineno">   14</span><span class="comment"> *</span></div>
<div class="line"><a id="l00015"></a><span class="lineno">   15</span><span class="comment"> *  Copyright 2023 Carnegie Mellon University.</span></div>
<div class="line"><a id="l00016"></a><span class="lineno">   16</span><span class="comment"> *</span></div>
<div class="line"><a id="l00017"></a><span class="lineno">   17</span><span class="comment"> *  NO WARRANTY. THIS CARNEGIE MELLON UNIVERSITY AND SOFTWARE ENGINEERING</span></div>
<div class="line"><a id="l00018"></a><span class="lineno">   18</span><span class="comment"> *  INSTITUTE MATERIAL IS FURNISHED ON AN &quot;AS-IS&quot; BASIS. CARNEGIE MELLON</span></div>
<div class="line"><a id="l00019"></a><span class="lineno">   19</span><span class="comment"> *  UNIVERSITY MAKES NO WARRANTIES OF ANY KIND, EITHER EXPRESSED OR IMPLIED,</span></div>
<div class="line"><a id="l00020"></a><span class="lineno">   20</span><span class="comment"> *  AS TO ANY MATTER INCLUDING, BUT NOT LIMITED TO, WARRANTY OF FITNESS FOR</span></div>
<div class="line"><a id="l00021"></a><span class="lineno">   21</span><span class="comment"> *  PURPOSE OR MERCHANTABILITY, EXCLUSIVITY, OR RESULTS OBTAINED FROM USE OF</span></div>
<div class="line"><a id="l00022"></a><span class="lineno">   22</span><span class="comment"> *  THE MATERIAL. CARNEGIE MELLON UNIVERSITY DOES NOT MAKE ANY WARRANTY OF</span></div>
<div class="line"><a id="l00023"></a><span class="lineno">   23</span><span class="comment"> *  ANY KIND WITH RESPECT TO FREEDOM FROM PATENT, TRADEMARK, OR COPYRIGHT</span></div>
<div class="line"><a id="l00024"></a><span class="lineno">   24</span><span class="comment"> *  INFRINGEMENT.</span></div>
<div class="line"><a id="l00025"></a><span class="lineno">   25</span><span class="comment"> *</span></div>
<div class="line"><a id="l00026"></a><span class="lineno">   26</span><span class="comment"> *  Licensed under a GNU GPL 2.0-style license, please see LICENSE.txt or</span></div>
<div class="line"><a id="l00027"></a><span class="lineno">   27</span><span class="comment"> *  contact permission@sei.cmu.edu for full terms.</span></div>
<div class="line"><a id="l00028"></a><span class="lineno">   28</span><span class="comment"> *</span></div>
<div class="line"><a id="l00029"></a><span class="lineno">   29</span><span class="comment"> *  [DISTRIBUTION STATEMENT A] This material has been approved for public</span></div>
<div class="line"><a id="l00030"></a><span class="lineno">   30</span><span class="comment"> *  release and unlimited distribution.  Please see Copyright notice for</span></div>
<div class="line"><a id="l00031"></a><span class="lineno">   31</span><span class="comment"> *  non-US Government use and distribution.</span></div>
<div class="line"><a id="l00032"></a><span class="lineno">   32</span><span class="comment"> *</span></div>
<div class="line"><a id="l00033"></a><span class="lineno">   33</span><span class="comment"> *  GOVERNMENT PURPOSE RIGHTS - Software and Software Documentation</span></div>
<div class="line"><a id="l00034"></a><span class="lineno">   34</span><span class="comment"> *  Contract No.: FA8702-15-D-0002</span></div>
<div class="line"><a id="l00035"></a><span class="lineno">   35</span><span class="comment"> *  Contractor Name: Carnegie Mellon University</span></div>
<div class="line"><a id="l00036"></a><span class="lineno">   36</span><span class="comment"> *  Contractor Address: 4500 Fifth Avenue, Pittsburgh, PA 15213</span></div>
<div class="line"><a id="l00037"></a><span class="lineno">   37</span><span class="comment"> *</span></div>
<div class="line"><a id="l00038"></a><span class="lineno">   38</span><span class="comment"> *  The Government&#39;s rights to use, modify, reproduce, release, perform,</span></div>
<div class="line"><a id="l00039"></a><span class="lineno">   39</span><span class="comment"> *  display, or disclose this software are restricted by paragraph (b)(2) of</span></div>
<div class="line"><a id="l00040"></a><span class="lineno">   40</span><span class="comment"> *  the Rights in Noncommercial Computer Software and Noncommercial Computer</span></div>
<div class="line"><a id="l00041"></a><span class="lineno">   41</span><span class="comment"> *  Software Documentation clause contained in the above identified</span></div>
<div class="line"><a id="l00042"></a><span class="lineno">   42</span><span class="comment"> *  contract. No restrictions apply after the expiration date shown</span></div>
<div class="line"><a id="l00043"></a><span class="lineno">   43</span><span class="comment"> *  above. Any reproduction of the software or portions thereof marked with</span></div>
<div class="line"><a id="l00044"></a><span class="lineno">   44</span><span class="comment"> *  this legend must also reproduce the markings.</span></div>
<div class="line"><a id="l00045"></a><span class="lineno">   45</span><span class="comment"> *</span></div>
<div class="line"><a id="l00046"></a><span class="lineno">   46</span><span class="comment"> *  This Software includes and/or makes use of Third-Party Software each</span></div>
<div class="line"><a id="l00047"></a><span class="lineno">   47</span><span class="comment"> *  subject to its own license.</span></div>
<div class="line"><a id="l00048"></a><span class="lineno">   48</span><span class="comment"> *</span></div>
<div class="line"><a id="l00049"></a><span class="lineno">   49</span><span class="comment"> *  DM23-2313</span></div>
<div class="line"><a id="l00050"></a><span class="lineno">   50</span><span class="comment"> *  @DISTRIBUTION_STATEMENT_END@</span></div>
<div class="line"><a id="l00051"></a><span class="lineno">   51</span><span class="comment"> *  ------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00052"></a><span class="lineno">   52</span><span class="comment"> */</span></div>
<div class="line"><a id="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00097"></a><span class="lineno">   97</span><span class="comment">/*</span></div>
<div class="line"><a id="l00098"></a><span class="lineno">   98</span><span class="comment"> *</span></div>
<div class="line"><a id="l00099"></a><span class="lineno">   99</span><span class="comment"> * Design notes:</span></div>
<div class="line"><a id="l00100"></a><span class="lineno">  100</span><span class="comment"> *</span></div>
<div class="line"><a id="l00101"></a><span class="lineno">  101</span><span class="comment"> * 1. For now, it is okay for the yfhook facility to only support a single</span></div>
<div class="line"><a id="l00102"></a><span class="lineno">  102</span><span class="comment"> * hook.</span></div>
<div class="line"><a id="l00103"></a><span class="lineno">  103</span><span class="comment"> *</span></div>
<div class="line"><a id="l00104"></a><span class="lineno">  104</span><span class="comment"> * 5. Each hook needs to know when a flow is flushed, so that it can make the</span></div>
<div class="line"><a id="l00105"></a><span class="lineno">  105</span><span class="comment"> * per-flow export fields available.</span></div>
<div class="line"><a id="l00106"></a><span class="lineno">  106</span><span class="comment"> *</span></div>
<div class="line"><a id="l00107"></a><span class="lineno">  107</span><span class="comment"> * Changes in Version 4:</span></div>
<div class="line"><a id="l00108"></a><span class="lineno">  108</span><span class="comment"> *</span></div>
<div class="line"><a id="l00109"></a><span class="lineno">  109</span><span class="comment"> * Added a function to pass a config file to the plugin from the command line.</span></div>
<div class="line"><a id="l00110"></a><span class="lineno">  110</span><span class="comment"> *</span></div>
<div class="line"><a id="l00111"></a><span class="lineno">  111</span><span class="comment"> * Changes in Version 3:</span></div>
<div class="line"><a id="l00112"></a><span class="lineno">  112</span><span class="comment"> *</span></div>
<div class="line"><a id="l00113"></a><span class="lineno">  113</span><span class="comment"> * Hooks export entire templates that will be added to Yaf&#39;s</span></div>
<div class="line"><a id="l00114"></a><span class="lineno">  114</span><span class="comment"> * subTemplateMultiList.</span></div>
<div class="line"><a id="l00115"></a><span class="lineno">  115</span><span class="comment"> * yfWriteFlow in yafcore.c will call ypGetTemplateCount (a function as of v.</span></div>
<div class="line"><a id="l00116"></a><span class="lineno">  116</span><span class="comment"> * 3),</span></div>
<div class="line"><a id="l00117"></a><span class="lineno">  117</span><span class="comment"> * which will return the number of templates Yaf should alloc in the STML.</span></div>
<div class="line"><a id="l00118"></a><span class="lineno">  118</span><span class="comment"> *  When</span></div>
<div class="line"><a id="l00119"></a><span class="lineno">  119</span><span class="comment"> * yfHookWriteFlow is called the STML entry can be added.  The hook should not</span></div>
<div class="line"><a id="l00120"></a><span class="lineno">  120</span><span class="comment"> * add NULL entries, if no template is to be added, ypGetTemplateCount should</span></div>
<div class="line"><a id="l00121"></a><span class="lineno">  121</span><span class="comment"> * return</span></div>
<div class="line"><a id="l00122"></a><span class="lineno">  122</span><span class="comment"> * 0.  If the STML entry contains list fields (BL&#39;s, STL&#39;s, STML&#39;s), it must</span></div>
<div class="line"><a id="l00123"></a><span class="lineno">  123</span><span class="comment"> * free</span></div>
<div class="line"><a id="l00124"></a><span class="lineno">  124</span><span class="comment"> * these in the call to ypFreeLists.  This means that the hook must maintain</span></div>
<div class="line"><a id="l00125"></a><span class="lineno">  125</span><span class="comment"> * access to the record so that it can free it.</span></div>
<div class="line"><a id="l00126"></a><span class="lineno">  126</span><span class="comment"> * ypFreeList does NOT free Yaf&#39;s STML, yaf will free this after all the hook&#39;s</span></div>
<div class="line"><a id="l00127"></a><span class="lineno">  127</span><span class="comment"> * lists have been freed.</span></div>
<div class="line"><a id="l00128"></a><span class="lineno">  128</span><span class="comment"> *</span></div>
<div class="line"><a id="l00129"></a><span class="lineno">  129</span><span class="comment"> * As of Version 3, ypGetTemplate will call fbTemplateAppendSpecArray and</span></div>
<div class="line"><a id="l00130"></a><span class="lineno">  130</span><span class="comment"> * fbSessionAddTemplate.  It does not need to internal templates, only</span></div>
<div class="line"><a id="l00131"></a><span class="lineno">  131</span><span class="comment"> * external.</span></div>
<div class="line"><a id="l00132"></a><span class="lineno">  132</span><span class="comment"> *</span></div>
<div class="line"><a id="l00133"></a><span class="lineno">  133</span><span class="comment"> * ypGetInfoModel should no longer be used.  ypGetTemplate should allocate the</span></div>
<div class="line"><a id="l00134"></a><span class="lineno">  134</span><span class="comment"> * info model and add the elements to the info model &amp; the template.</span></div>
<div class="line"><a id="l00135"></a><span class="lineno">  135</span><span class="comment"> *</span></div>
<div class="line"><a id="l00136"></a><span class="lineno">  136</span><span class="comment"> * Versions 2 or Below:</span></div>
<div class="line"><a id="l00137"></a><span class="lineno">  137</span><span class="comment"> *</span></div>
<div class="line"><a id="l00138"></a><span class="lineno">  138</span><span class="comment"> * Each hook needs to be able to hand YAF an export template for its fields.</span></div>
<div class="line"><a id="l00139"></a><span class="lineno">  139</span><span class="comment"> * These fields will appear in every exported record; a facility for NULLs MUST</span></div>
<div class="line"><a id="l00140"></a><span class="lineno">  140</span><span class="comment"> * be provided by the hook&#39;s representation.</span></div>
<div class="line"><a id="l00141"></a><span class="lineno">  141</span><span class="comment"> *</span></div>
<div class="line"><a id="l00142"></a><span class="lineno">  142</span><span class="comment"> */</span></div>
<div class="line"><a id="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144"></a><span class="lineno">  144</span><span class="preprocessor">#ifndef _YAF_HOOKS_H_</span></div>
<div class="line"><a id="l00145"></a><span class="lineno">  145</span><span class="preprocessor">#define _YAF_HOOKS_H_</span></div>
<div class="line"><a id="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147"></a><span class="lineno">  147</span><span class="preprocessor">#include &lt;yaf/autoinc.h&gt;</span></div>
<div class="line"><a id="l00148"></a><span class="lineno">  148</span><span class="preprocessor">#include &lt;yaf/decode.h&gt;</span></div>
<div class="line"><a id="l00149"></a><span class="lineno">  149</span><span class="preprocessor">#include &lt;<a class="code" href="yafcore_8h.html">yaf/yafcore.h</a>&gt;</span></div>
<div class="line"><a id="l00150"></a><span class="lineno">  150</span><span class="preprocessor">#include &lt;<a class="code" href="yaftab_8h.html">yaf/yaftab.h</a>&gt;</span></div>
<div class="line"><a id="l00151"></a><span class="lineno">  151</span><span class="preprocessor">#if YAF_ENABLE_APPLABEL</span></div>
<div class="line"><a id="l00152"></a><span class="lineno">  152</span><span class="preprocessor">#include &lt;pcre.h&gt;</span></div>
<div class="line"><a id="l00153"></a><span class="lineno">  153</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00156"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a6f5462653bd733272e147c5cdab88392">  156</a></span><span class="preprocessor">#define YAF_HOOK_INTERFACE_VERSION 6</span></div>
<div class="line"><a id="l00157"></a><span class="lineno">  157</span> </div>
<div class="foldopen" id="foldopen00160" data-start="{" data-end="};">
<div class="line"><a id="l00160"></a><span class="lineno"><a class="line" href="structyf_hook_meta_data.html">  160</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structyf_hook_meta_data.html">yfHookMetaData</a> {</div>
<div class="line"><a id="l00162"></a><span class="lineno"><a class="line" href="structyf_hook_meta_data.html#a2ea51d6132e6e770bd0ef178ba9a85dd">  162</a></span>    uint8_t    <a class="code hl_variable" href="structyf_hook_meta_data.html#a2ea51d6132e6e770bd0ef178ba9a85dd">version</a>;</div>
<div class="line"><a id="l00164"></a><span class="lineno"><a class="line" href="structyf_hook_meta_data.html#ac3d25e5e00ddc18fbc64515ef50dba16">  164</a></span>    uint32_t   <a class="code hl_variable" href="structyf_hook_meta_data.html#ac3d25e5e00ddc18fbc64515ef50dba16">exportDataSize</a>;</div>
<div class="line"><a id="l00166"></a><span class="lineno"><a class="line" href="structyf_hook_meta_data.html#a5007c33347fff76425a241abefd11b52">  166</a></span>    uint8_t    <a class="code hl_variable" href="structyf_hook_meta_data.html#a5007c33347fff76425a241abefd11b52">requireAppLabel</a>;</div>
<div class="line"><a id="l00167"></a><span class="lineno">  167</span>};</div>
</div>
<div class="line"><a id="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00182"></a><span class="lineno">  182</span>gboolean</div>
<div class="line"><a id="l00183"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a852aeb6f01850c2dd5e18ec8db20923d">  183</a></span><a class="code hl_function" href="yafhooks_8h.html#a852aeb6f01850c2dd5e18ec8db20923d">yfHookPacket</a>(</div>
<div class="line"><a id="l00184"></a><span class="lineno">  184</span>    <a class="code hl_struct" href="structyf_flow_key__st.html">yfFlowKey_t</a>    *key,</div>
<div class="line"><a id="l00185"></a><span class="lineno">  185</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00186"></a><span class="lineno">  186</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00187"></a><span class="lineno">  187</span>    uint32_t        iplen,</div>
<div class="line"><a id="l00188"></a><span class="lineno">  188</span>    <a class="code hl_struct" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a>    *tcpinfo,</div>
<div class="line"><a id="l00189"></a><span class="lineno">  189</span>    <a class="code hl_struct" href="structyf_l2_info__st.html">yfL2Info_t</a>     *l2info);</div>
<div class="line"><a id="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00203"></a><span class="lineno">  203</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00204"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a2112c22cdbf290ffe4ebfbaa6cab48bb">  204</a></span><a class="code hl_function" href="yafhooks_8h.html#a2112c22cdbf290ffe4ebfbaa6cab48bb">yfHookFlowPacket</a>(</div>
<div class="line"><a id="l00205"></a><span class="lineno">  205</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>       *flow,</div>
<div class="line"><a id="l00206"></a><span class="lineno">  206</span>    <a class="code hl_struct" href="structyf_flow_val__st.html">yfFlowVal_t</a>    *val,</div>
<div class="line"><a id="l00207"></a><span class="lineno">  207</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00208"></a><span class="lineno">  208</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00209"></a><span class="lineno">  209</span>    uint32_t        iplen,</div>
<div class="line"><a id="l00210"></a><span class="lineno">  210</span>    <a class="code hl_struct" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a>    *tcpinfo,</div>
<div class="line"><a id="l00211"></a><span class="lineno">  211</span>    <a class="code hl_struct" href="structyf_l2_info__st.html">yfL2Info_t</a>     *l2info);</div>
<div class="line"><a id="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00230"></a><span class="lineno">  230</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00231"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#af9cb8ca0bb783590930746c131847011">  231</a></span><a class="code hl_function" href="yafhooks_8h.html#af9cb8ca0bb783590930746c131847011">yfHookValidateFlowTab</a>(</div>
<div class="line"><a id="l00232"></a><span class="lineno">  232</span>    <span class="keywordtype">void</span>     **yfctx,</div>
<div class="line"><a id="l00233"></a><span class="lineno">  233</span>    uint32_t   max_payload,</div>
<div class="line"><a id="l00234"></a><span class="lineno">  234</span>    gboolean   uniflow,</div>
<div class="line"><a id="l00235"></a><span class="lineno">  235</span>    gboolean   silkmode,</div>
<div class="line"><a id="l00236"></a><span class="lineno">  236</span>    gboolean   applabelmode,</div>
<div class="line"><a id="l00237"></a><span class="lineno">  237</span>    gboolean   entropymode,</div>
<div class="line"><a id="l00238"></a><span class="lineno">  238</span>    gboolean   fingerprintmode,</div>
<div class="line"><a id="l00239"></a><span class="lineno">  239</span>    gboolean   fpExportMode,</div>
<div class="line"><a id="l00240"></a><span class="lineno">  240</span>    gboolean   udp_max_payload,</div>
<div class="line"><a id="l00241"></a><span class="lineno">  241</span>    uint16_t   udp_uniflow_port);</div>
<div class="line"><a id="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00250"></a><span class="lineno">  250</span>gboolean</div>
<div class="line"><a id="l00251"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a9b801e783cc418a5d6b4625984a9557e">  251</a></span><a class="code hl_function" href="yafhooks_8h.html#a9b801e783cc418a5d6b4625984a9557e">yfHookFlowClose</a>(</div>
<div class="line"><a id="l00252"></a><span class="lineno">  252</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00265"></a><span class="lineno">  265</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00266"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#ac628e362d15d7cb034343829668bfbcf">  266</a></span><a class="code hl_function" href="yafhooks_8h.html#ac628e362d15d7cb034343829668bfbcf">yfHookFlowAlloc</a>(</div>
<div class="line"><a id="l00267"></a><span class="lineno">  267</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow,</div>
<div class="line"><a id="l00268"></a><span class="lineno">  268</span>    <span class="keywordtype">void</span>     **yfctx);</div>
<div class="line"><a id="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00277"></a><span class="lineno">  277</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00278"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a0a95321f578ab86b78f7e7c348e2b004">  278</a></span><a class="code hl_function" href="yafhooks_8h.html#a0a95321f578ab86b78f7e7c348e2b004">yfHookFlowFree</a>(</div>
<div class="line"><a id="l00279"></a><span class="lineno">  279</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00287"></a><span class="lineno">  287</span>fbInfoElement_t *</div>
<div class="line"><a id="l00288"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a70de3d7b34b2ac57361c7b3c63bb77d7">  288</a></span><a class="code hl_function" href="yafhooks_8h.html#a70de3d7b34b2ac57361c7b3c63bb77d7">yfHookGetInfoModel</a>(</div>
<div class="line"><a id="l00289"></a><span class="lineno">  289</span>    <span class="keywordtype">void</span>);</div>
<div class="line"><a id="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00300"></a><span class="lineno">  300</span>gboolean</div>
<div class="line"><a id="l00301"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a3f9d70dbb8a7a2ab72e82977be7b4596">  301</a></span><a class="code hl_function" href="yafhooks_8h.html#a3f9d70dbb8a7a2ab72e82977be7b4596">yfHookGetTemplate</a>(</div>
<div class="line"><a id="l00302"></a><span class="lineno">  302</span>    fbSession_t  *session);</div>
<div class="line"><a id="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00313"></a><span class="lineno">  313</span>gboolean</div>
<div class="line"><a id="l00314"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a3258c77bd8bb2cebf6336a484bb0b641">  314</a></span><a class="code hl_function" href="yafhooks_8h.html#a3258c77bd8bb2cebf6336a484bb0b641">yfHookFlowWrite</a>(</div>
<div class="line"><a id="l00315"></a><span class="lineno">  315</span>    fbSubTemplateMultiList_t       *rec,</div>
<div class="line"><a id="l00316"></a><span class="lineno">  316</span>    fbSubTemplateMultiListEntry_t  *stml,</div>
<div class="line"><a id="l00317"></a><span class="lineno">  317</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>                       *flow,</div>
<div class="line"><a id="l00318"></a><span class="lineno">  318</span>    GError                        **err);</div>
<div class="line"><a id="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00333"></a><span class="lineno">  333</span>gboolean</div>
<div class="line"><a id="l00334"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49">  334</a></span><a class="code hl_function" href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49">yfHookAddNewHook</a>(</div>
<div class="line"><a id="l00335"></a><span class="lineno">  335</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>  *hookName,</div>
<div class="line"><a id="l00336"></a><span class="lineno">  336</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>  *hookOpts,</div>
<div class="line"><a id="l00337"></a><span class="lineno">  337</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>  *hookConf,</div>
<div class="line"><a id="l00338"></a><span class="lineno">  338</span>    <span class="keywordtype">void</span>       **yfctx,</div>
<div class="line"><a id="l00339"></a><span class="lineno">  339</span>    GError     **err);</div>
<div class="line"><a id="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341"></a><span class="lineno">  341</span><span class="preprocessor">#if YAF_ENABLE_APPLABEL</span></div>
<div class="line"><a id="l00354"></a><span class="lineno">  354</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00355"></a><span class="lineno">  355</span>yfHookScanPayload(</div>
<div class="line"><a id="l00356"></a><span class="lineno">  356</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>       *flow,</div>
<div class="line"><a id="l00357"></a><span class="lineno">  357</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00358"></a><span class="lineno">  358</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00359"></a><span class="lineno">  359</span>    pcre           *expression,</div>
<div class="line"><a id="l00360"></a><span class="lineno">  360</span>    uint32_t        offset,</div>
<div class="line"><a id="l00361"></a><span class="lineno">  361</span>    uint16_t        elementID,</div>
<div class="line"><a id="l00362"></a><span class="lineno">  362</span>    uint16_t        applabel);</div>
<div class="line"><a id="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364"></a><span class="lineno">  364</span><span class="preprocessor">#endif </span><span class="comment">/* if YAF_ENABLE_APPLABEL */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00373"></a><span class="lineno">  373</span>uint8_t</div>
<div class="line"><a id="l00374"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a732a95ddea0e0d150ce418261ba1d115">  374</a></span><a class="code hl_function" href="yafhooks_8h.html#a732a95ddea0e0d150ce418261ba1d115">yfHookGetTemplateCount</a>(</div>
<div class="line"><a id="l00375"></a><span class="lineno">  375</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00383"></a><span class="lineno">  383</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00384"></a><span class="lineno"><a class="line" href="yafhooks_8h.html#a9416f3b5e9dcc40e47563622b645e7a9">  384</a></span><a class="code hl_function" href="yafhooks_8h.html#a9416f3b5e9dcc40e47563622b645e7a9">yfHookFreeLists</a>(</div>
<div class="line"><a id="l00385"></a><span class="lineno">  385</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388"></a><span class="lineno">  388</span><span class="comment">/*</span></div>
<div class="line"><a id="l00389"></a><span class="lineno">  389</span><span class="comment"> *  The following are the prototypes of the functions that must be defined for</span></div>
<div class="line"><a id="l00390"></a><span class="lineno">  390</span><span class="comment"> *  a hook to be loaded into YAF.  They are declared here to help ensure the</span></div>
<div class="line"><a id="l00391"></a><span class="lineno">  391</span><span class="comment"> *  hook uses the correct function signature.</span></div>
<div class="line"><a id="l00392"></a><span class="lineno">  392</span><span class="comment"> */</span></div>
<div class="line"><a id="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394"></a><span class="lineno">  394</span><span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structyf_hook_meta_data.html">yfHookMetaData</a> *</div>
<div class="line"><a id="l00395"></a><span class="lineno">  395</span>ypGetMetaData(</div>
<div class="line"><a id="l00396"></a><span class="lineno">  396</span>    <span class="keywordtype">void</span>);</div>
<div class="line"><a id="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398"></a><span class="lineno">  398</span>gboolean</div>
<div class="line"><a id="l00399"></a><span class="lineno">  399</span>ypHookPacket(</div>
<div class="line"><a id="l00400"></a><span class="lineno">  400</span>    <a class="code hl_struct" href="structyf_flow_key__st.html">yfFlowKey_t</a>    *key,</div>
<div class="line"><a id="l00401"></a><span class="lineno">  401</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00402"></a><span class="lineno">  402</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00403"></a><span class="lineno">  403</span>    uint32_t        iplen,</div>
<div class="line"><a id="l00404"></a><span class="lineno">  404</span>    <a class="code hl_struct" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a>    *tcpinfo,</div>
<div class="line"><a id="l00405"></a><span class="lineno">  405</span>    <a class="code hl_struct" href="structyf_l2_info__st.html">yfL2Info_t</a>     *l2info);</div>
<div class="line"><a id="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407"></a><span class="lineno">  407</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00408"></a><span class="lineno">  408</span>ypFlowPacket(</div>
<div class="line"><a id="l00409"></a><span class="lineno">  409</span>    <span class="keywordtype">void</span>           *yfHookConext,</div>
<div class="line"><a id="l00410"></a><span class="lineno">  410</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>       *flow,</div>
<div class="line"><a id="l00411"></a><span class="lineno">  411</span>    <a class="code hl_struct" href="structyf_flow_val__st.html">yfFlowVal_t</a>    *val,</div>
<div class="line"><a id="l00412"></a><span class="lineno">  412</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00413"></a><span class="lineno">  413</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00414"></a><span class="lineno">  414</span>    uint32_t        iplen,</div>
<div class="line"><a id="l00415"></a><span class="lineno">  415</span>    <a class="code hl_struct" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a>    *tcpinfo,</div>
<div class="line"><a id="l00416"></a><span class="lineno">  416</span>    <a class="code hl_struct" href="structyf_l2_info__st.html">yfL2Info_t</a>     *l2info);</div>
<div class="line"><a id="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00418"></a><span class="lineno">  418</span>gboolean</div>
<div class="line"><a id="l00419"></a><span class="lineno">  419</span>ypFlowClose(</div>
<div class="line"><a id="l00420"></a><span class="lineno">  420</span>    <span class="keywordtype">void</span>      *yfHookConext,</div>
<div class="line"><a id="l00421"></a><span class="lineno">  421</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423"></a><span class="lineno">  423</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00424"></a><span class="lineno">  424</span>ypFlowAlloc(</div>
<div class="line"><a id="l00425"></a><span class="lineno">  425</span>    <span class="keywordtype">void</span>     **yfHookConext,</div>
<div class="line"><a id="l00426"></a><span class="lineno">  426</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow,</div>
<div class="line"><a id="l00427"></a><span class="lineno">  427</span>    <span class="keywordtype">void</span>      *yfctx);</div>
<div class="line"><a id="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429"></a><span class="lineno">  429</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00430"></a><span class="lineno">  430</span>ypFlowFree(</div>
<div class="line"><a id="l00431"></a><span class="lineno">  431</span>    <span class="keywordtype">void</span>      *yfHookConext,</div>
<div class="line"><a id="l00432"></a><span class="lineno">  432</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434"></a><span class="lineno">  434</span>gboolean</div>
<div class="line"><a id="l00435"></a><span class="lineno">  435</span>ypFlowWrite(</div>
<div class="line"><a id="l00436"></a><span class="lineno">  436</span>    <span class="keywordtype">void</span>                           *yfHookConext,</div>
<div class="line"><a id="l00437"></a><span class="lineno">  437</span>    fbSubTemplateMultiList_t       *rec,</div>
<div class="line"><a id="l00438"></a><span class="lineno">  438</span>    fbSubTemplateMultiListEntry_t  *stml,</div>
<div class="line"><a id="l00439"></a><span class="lineno">  439</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>                       *flow,</div>
<div class="line"><a id="l00440"></a><span class="lineno">  440</span>    GError                        **err);</div>
<div class="line"><a id="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442"></a><span class="lineno">  442</span>fbInfoElement_t *</div>
<div class="line"><a id="l00443"></a><span class="lineno">  443</span>ypGetInfoModel(</div>
<div class="line"><a id="l00444"></a><span class="lineno">  444</span>    <span class="keywordtype">void</span>);</div>
<div class="line"><a id="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446"></a><span class="lineno">  446</span>gboolean</div>
<div class="line"><a id="l00447"></a><span class="lineno">  447</span>ypGetTemplate(</div>
<div class="line"><a id="l00448"></a><span class="lineno">  448</span>    fbSession_t  *session);</div>
<div class="line"><a id="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450"></a><span class="lineno">  450</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00451"></a><span class="lineno">  451</span>ypSetPluginOpt(</div>
<div class="line"><a id="l00452"></a><span class="lineno">  452</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>  *pluginOpt,</div>
<div class="line"><a id="l00453"></a><span class="lineno">  453</span>    <span class="keywordtype">void</span>        *yfctx);</div>
<div class="line"><a id="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455"></a><span class="lineno">  455</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00456"></a><span class="lineno">  456</span>ypSetPluginConf(</div>
<div class="line"><a id="l00457"></a><span class="lineno">  457</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>  *pluginConf,</div>
<div class="line"><a id="l00458"></a><span class="lineno">  458</span>    <span class="keywordtype">void</span>       **yfctx);</div>
<div class="line"><a id="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460"></a><span class="lineno">  460</span><span class="preprocessor">#if YAF_ENABLE_APPLABEL</span></div>
<div class="line"><a id="l00461"></a><span class="lineno">  461</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00462"></a><span class="lineno">  462</span>ypScanPayload(</div>
<div class="line"><a id="l00463"></a><span class="lineno">  463</span>    <span class="keywordtype">void</span>           *yfHookConext,</div>
<div class="line"><a id="l00464"></a><span class="lineno">  464</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>       *flow,</div>
<div class="line"><a id="l00465"></a><span class="lineno">  465</span>    <span class="keyword">const</span> uint8_t  *pkt,</div>
<div class="line"><a id="l00466"></a><span class="lineno">  466</span>    <span class="keywordtype">size_t</span>          caplen,</div>
<div class="line"><a id="l00467"></a><span class="lineno">  467</span>    pcre           *expression,</div>
<div class="line"><a id="l00468"></a><span class="lineno">  468</span>    uint32_t        offset,</div>
<div class="line"><a id="l00469"></a><span class="lineno">  469</span>    uint16_t        elementID,</div>
<div class="line"><a id="l00470"></a><span class="lineno">  470</span>    uint16_t        applabel);</div>
<div class="line"><a id="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472"></a><span class="lineno">  472</span><span class="preprocessor">#endif </span><span class="comment">/* YAF_ENABLE_APPLABEL */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474"></a><span class="lineno">  474</span>gboolean</div>
<div class="line"><a id="l00475"></a><span class="lineno">  475</span>ypValidateFlowTab(</div>
<div class="line"><a id="l00476"></a><span class="lineno">  476</span>    <span class="keywordtype">void</span>      *yfctx,</div>
<div class="line"><a id="l00477"></a><span class="lineno">  477</span>    uint32_t   max_payload,</div>
<div class="line"><a id="l00478"></a><span class="lineno">  478</span>    gboolean   uniflow,</div>
<div class="line"><a id="l00479"></a><span class="lineno">  479</span>    gboolean   silkmode,</div>
<div class="line"><a id="l00480"></a><span class="lineno">  480</span>    gboolean   applabelmode,</div>
<div class="line"><a id="l00481"></a><span class="lineno">  481</span>    gboolean   entropymode,</div>
<div class="line"><a id="l00482"></a><span class="lineno">  482</span>    gboolean   fingerprintmode,</div>
<div class="line"><a id="l00483"></a><span class="lineno">  483</span>    gboolean   fpExportMode,</div>
<div class="line"><a id="l00484"></a><span class="lineno">  484</span>    gboolean   udp_max_payload,</div>
<div class="line"><a id="l00485"></a><span class="lineno">  485</span>    uint16_t   udp_uniflow_port,</div>
<div class="line"><a id="l00486"></a><span class="lineno">  486</span>    GError   **err);</div>
<div class="line"><a id="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488"></a><span class="lineno">  488</span>uint8_t</div>
<div class="line"><a id="l00489"></a><span class="lineno">  489</span>ypGetTemplateCount(</div>
<div class="line"><a id="l00490"></a><span class="lineno">  490</span>    <span class="keywordtype">void</span>      *yfHookConext,</div>
<div class="line"><a id="l00491"></a><span class="lineno">  491</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493"></a><span class="lineno">  493</span><span class="keywordtype">void</span></div>
<div class="line"><a id="l00494"></a><span class="lineno">  494</span>ypFreeLists(</div>
<div class="line"><a id="l00495"></a><span class="lineno">  495</span>    <span class="keywordtype">void</span>      *yfHookConext,</div>
<div class="line"><a id="l00496"></a><span class="lineno">  496</span>    <a class="code hl_struct" href="structyf_flow__st.html">yfFlow_t</a>  *flow);</div>
<div class="line"><a id="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498"></a><span class="lineno">  498</span><span class="preprocessor">#endif </span><span class="comment">/* _YAF_HOOKS_H_ */</span><span class="preprocessor"></span></div>
<div class="ttc" id="astructyf_flow__st_html"><div class="ttname"><a href="structyf_flow__st.html">yfFlow_st</a></div><div class="ttdoc">A YAF flow.</div><div class="ttdef"><b>Definition</b> yafcore.h:377</div></div>
<div class="ttc" id="astructyf_flow_key__st_html"><div class="ttname"><a href="structyf_flow_key__st.html">yfFlowKey_st</a></div><div class="ttdoc">A YAF flow key.</div><div class="ttdef"><b>Definition</b> yafcore.h:212</div></div>
<div class="ttc" id="astructyf_flow_val__st_html"><div class="ttname"><a href="structyf_flow_val__st.html">yfFlowVal_st</a></div><div class="ttdoc">A YAF uniflow value.</div><div class="ttdef"><b>Definition</b> yafcore.h:282</div></div>
<div class="ttc" id="astructyf_hook_meta_data_html"><div class="ttname"><a href="structyf_hook_meta_data.html">yfHookMetaData</a></div><div class="ttdoc">Exported from the plugin to tell YAF about its export data &amp; interface version.</div><div class="ttdef"><b>Definition</b> yafhooks.h:160</div></div>
<div class="ttc" id="astructyf_hook_meta_data_html_a2ea51d6132e6e770bd0ef178ba9a85dd"><div class="ttname"><a href="structyf_hook_meta_data.html#a2ea51d6132e6e770bd0ef178ba9a85dd">yfHookMetaData::version</a></div><div class="ttdeci">uint8_t version</div><div class="ttdoc">version of plugin interface</div><div class="ttdef"><b>Definition</b> yafhooks.h:162</div></div>
<div class="ttc" id="astructyf_hook_meta_data_html_a5007c33347fff76425a241abefd11b52"><div class="ttname"><a href="structyf_hook_meta_data.html#a5007c33347fff76425a241abefd11b52">yfHookMetaData::requireAppLabel</a></div><div class="ttdeci">uint8_t requireAppLabel</div><div class="ttdoc">turn on application labeling related functions</div><div class="ttdef"><b>Definition</b> yafhooks.h:166</div></div>
<div class="ttc" id="astructyf_hook_meta_data_html_ac3d25e5e00ddc18fbc64515ef50dba16"><div class="ttname"><a href="structyf_hook_meta_data.html#ac3d25e5e00ddc18fbc64515ef50dba16">yfHookMetaData::exportDataSize</a></div><div class="ttdeci">uint32_t exportDataSize</div><div class="ttdoc">size of data plugin will export</div><div class="ttdef"><b>Definition</b> yafhooks.h:164</div></div>
<div class="ttc" id="astructyf_l2_info__st_html"><div class="ttname"><a href="structyf_l2_info__st.html">yfL2Info_st</a></div><div class="ttdoc">Datalink layer information structure.</div><div class="ttdef"><b>Definition</b> decode.h:106</div></div>
<div class="ttc" id="astructyf_t_c_p_info__st_html"><div class="ttname"><a href="structyf_t_c_p_info__st.html">yfTCPInfo_st</a></div><div class="ttdoc">TCP information structure.</div><div class="ttdef"><b>Definition</b> decode.h:136</div></div>
<div class="ttc" id="ayafcore_8h_html"><div class="ttname"><a href="yafcore_8h.html">yafcore.h</a></div><div class="ttdoc">YAF Core Library.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a0a95321f578ab86b78f7e7c348e2b004"><div class="ttname"><a href="yafhooks_8h.html#a0a95321f578ab86b78f7e7c348e2b004">yfHookFlowFree</a></div><div class="ttdeci">void yfHookFlowFree(yfFlow_t *flow)</div><div class="ttdoc">Frees all memory associated with the flow state in all of the attached plugins.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a2112c22cdbf290ffe4ebfbaa6cab48bb"><div class="ttname"><a href="yafhooks_8h.html#a2112c22cdbf290ffe4ebfbaa6cab48bb">yfHookFlowPacket</a></div><div class="ttdeci">void yfHookFlowPacket(yfFlow_t *flow, yfFlowVal_t *val, const uint8_t *pkt, size_t caplen, uint32_t iplen, yfTCPInfo_t *tcpinfo, yfL2Info_t *l2info)</div><div class="ttdoc">Similar to yfHookPacket but also given yfFlowVal_t struct for processing per flow direction.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a3258c77bd8bb2cebf6336a484bb0b641"><div class="ttname"><a href="yafhooks_8h.html#a3258c77bd8bb2cebf6336a484bb0b641">yfHookFlowWrite</a></div><div class="ttdeci">gboolean yfHookFlowWrite(fbSubTemplateMultiList_t *rec, fbSubTemplateMultiListEntry_t *stml, yfFlow_t *flow, GError **err)</div><div class="ttdoc">called by yfWriteFlow to add the data from all registered plugins to the outgoing IPFIX record</div></div>
<div class="ttc" id="ayafhooks_8h_html_a3bbe4cceea2466b23053af3dfde1ad49"><div class="ttname"><a href="yafhooks_8h.html#a3bbe4cceea2466b23053af3dfde1ad49">yfHookAddNewHook</a></div><div class="ttdeci">gboolean yfHookAddNewHook(const char *hookName, const char *hookOpts, const char *hookConf, void **yfctx, GError **err)</div><div class="ttdoc">Adds another hook (plugin) into yaf.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a3f9d70dbb8a7a2ab72e82977be7b4596"><div class="ttname"><a href="yafhooks_8h.html#a3f9d70dbb8a7a2ab72e82977be7b4596">yfHookGetTemplate</a></div><div class="ttdeci">gboolean yfHookGetTemplate(fbSession_t *session)</div><div class="ttdoc">Gets the IPFIX info model template for the export data from all the plugins and turns it into a singl...</div></div>
<div class="ttc" id="ayafhooks_8h_html_a70de3d7b34b2ac57361c7b3c63bb77d7"><div class="ttname"><a href="yafhooks_8h.html#a70de3d7b34b2ac57361c7b3c63bb77d7">yfHookGetInfoModel</a></div><div class="ttdeci">fbInfoElement_t * yfHookGetInfoModel(void)</div><div class="ttdoc">Returns the IPFIX info model aggregated for all plugins.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a732a95ddea0e0d150ce418261ba1d115"><div class="ttname"><a href="yafhooks_8h.html#a732a95ddea0e0d150ce418261ba1d115">yfHookGetTemplateCount</a></div><div class="ttdeci">uint8_t yfHookGetTemplateCount(yfFlow_t *flow)</div><div class="ttdoc">Returns the amount of templates to add to the SubtemplateMultiList from all plugins hooked.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a852aeb6f01850c2dd5e18ec8db20923d"><div class="ttname"><a href="yafhooks_8h.html#a852aeb6f01850c2dd5e18ec8db20923d">yfHookPacket</a></div><div class="ttdeci">gboolean yfHookPacket(yfFlowKey_t *key, const uint8_t *pkt, size_t caplen, uint32_t iplen, yfTCPInfo_t *tcpinfo, yfL2Info_t *l2info)</div><div class="ttdoc">Function called to do processing on each packet as it comes in.</div></div>
<div class="ttc" id="ayafhooks_8h_html_a9416f3b5e9dcc40e47563622b645e7a9"><div class="ttname"><a href="yafhooks_8h.html#a9416f3b5e9dcc40e47563622b645e7a9">yfHookFreeLists</a></div><div class="ttdeci">void yfHookFreeLists(yfFlow_t *flow)</div><div class="ttdoc">Sends control back to the plugin to free any BasicLists, SubTemplateLists, or SubTemplateMultiLists t...</div></div>
<div class="ttc" id="ayafhooks_8h_html_a9b801e783cc418a5d6b4625984a9557e"><div class="ttname"><a href="yafhooks_8h.html#a9b801e783cc418a5d6b4625984a9557e">yfHookFlowClose</a></div><div class="ttdeci">gboolean yfHookFlowClose(yfFlow_t *flow)</div><div class="ttdoc">Called upon flow close to do any necessary plugin processing upon flow close.</div></div>
<div class="ttc" id="ayafhooks_8h_html_ac628e362d15d7cb034343829668bfbcf"><div class="ttname"><a href="yafhooks_8h.html#ac628e362d15d7cb034343829668bfbcf">yfHookFlowAlloc</a></div><div class="ttdeci">void yfHookFlowAlloc(yfFlow_t *flow, void **yfctx)</div><div class="ttdoc">Allow plugins to allocate flow state information for each flow captured by yaf at the time of flow cr...</div></div>
<div class="ttc" id="ayafhooks_8h_html_af9cb8ca0bb783590930746c131847011"><div class="ttname"><a href="yafhooks_8h.html#af9cb8ca0bb783590930746c131847011">yfHookValidateFlowTab</a></div><div class="ttdeci">void yfHookValidateFlowTab(void **yfctx, uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port)</div><div class="ttdoc">Validation function to make sure the plugin can and should operate based on the flowtable options.</div></div>
<div class="ttc" id="ayaftab_8h_html"><div class="ttname"><a href="yaftab_8h.html">yaftab.h</a></div><div class="ttdoc">Flow generation interface for YAF.</div></div>
</div><!-- fragment --></div><!-- contents -->
</body>
</html>
