<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
<!-- BEGIN NETSA-DOXYGEN HEADER -->
<head>
<title>Airframe Application Utilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<!-- All pages must include the following stylesheets -->
<link rel="stylesheet" type="text/css" href="doxygen.css" />
<link rel="stylesheet" type="text/css" href="tabs.css" />
<link rel="stylesheet" type="text/css" href="tools.css" />
</head>
<!--#include virtual="/tools-page-header.shtml"-->
<body>
<div class="tool-header">
<div class="bigtext">Airframe Application Utilities</div>
libairframe 2.12.0 API documentation
</div><!-- tool-header -->
<!-- END NETSA-DOXYGEN HEADER -->
<div class="page-content">
<br />
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_474a9ac5faa6f01ed6774ebb674504b2.html">hg-yaf</a></li><li class="navelem"><a class="el" href="dir_de4b0aca1fc2b528c2bad74d0188357d.html">airframe</a></li><li class="navelem"><a class="el" href="dir_4d15b44975c8ac394570efc4a3796bcc.html">include</a></li><li class="navelem"><a class="el" href="dir_c6580e1ee282fc8e1bdf48d5295600f2.html">airframe</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">privconfig.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Airframe Privilege Configuration Support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;airframe/autoinc.h&gt;</code><br />
<code>#include &lt;<a class="el" href="airopt_8h_source.html">airframe/airopt.h</a>&gt;</code><br />
</div>
<p><a href="privconfig_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a516fb1f464723974d30513c4edf200e8"><td class="memItemLeft" align="right" valign="top"><a id="a516fb1f464723974d30513c4edf200e8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a516fb1f464723974d30513c4edf200e8">PRIVC_ERROR_DOMAIN</a>&#160;&#160;&#160;g_quark_from_string(&quot;airframePrivilegeError&quot;)</td></tr>
<tr class="memdesc:a516fb1f464723974d30513c4edf200e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">GError domain for privconfig errors. <br /></td></tr>
<tr class="separator:a516fb1f464723974d30513c4edf200e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6c118216deb5345451bf0c9e63bf35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a0e6c118216deb5345451bf0c9e63bf35">PRIVC_ERROR_SETUP</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a0e6c118216deb5345451bf0c9e63bf35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Privconfig setup error.  <a href="privconfig_8h.html#a0e6c118216deb5345451bf0c9e63bf35">More...</a><br /></td></tr>
<tr class="separator:a0e6c118216deb5345451bf0c9e63bf35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44b6849004a727ca928e860c07888f36"><td class="memItemLeft" align="right" valign="top"><a id="a44b6849004a727ca928e860c07888f36"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a44b6849004a727ca928e860c07888f36">PRIVC_ERROR_FAILED</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:a44b6849004a727ca928e860c07888f36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Privilege drop error. <br /></td></tr>
<tr class="separator:a44b6849004a727ca928e860c07888f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68010243fa68d45965ddf2f30acfe2f0"><td class="memItemLeft" align="right" valign="top"><a id="a68010243fa68d45965ddf2f30acfe2f0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a68010243fa68d45965ddf2f30acfe2f0">PRIVC_ERROR_ALREADY</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:a68010243fa68d45965ddf2f30acfe2f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Couldn't drop privilege because privilege already dropped. <br /></td></tr>
<tr class="separator:a68010243fa68d45965ddf2f30acfe2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e8801fd73088fa746b0f069187c30a"><td class="memItemLeft" align="right" valign="top"><a id="ae6e8801fd73088fa746b0f069187c30a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#ae6e8801fd73088fa746b0f069187c30a">PRIVC_ERROR_NODROP</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ae6e8801fd73088fa746b0f069187c30a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Won't drop privilege because not running as root. <br /></td></tr>
<tr class="separator:ae6e8801fd73088fa746b0f069187c30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fef5cd302addbb6d031a526bca66103"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a4fef5cd302addbb6d031a526bca66103">privc_add_option_group</a> (<a class="el" href="airopt_8h.html#ab416f9c421f4fc3f525e1742b4a13b6f">AirOptionCtx</a> *aoctx)</td></tr>
<tr class="memdesc:a4fef5cd302addbb6d031a526bca66103"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return an option group for privilege configuration.  <a href="privconfig_8h.html#a4fef5cd302addbb6d031a526bca66103">More...</a><br /></td></tr>
<tr class="separator:a4fef5cd302addbb6d031a526bca66103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8638d51e2c67417c2b153574d6dd3516"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a8638d51e2c67417c2b153574d6dd3516">privc_setup</a> (GError **err)</td></tr>
<tr class="memdesc:a8638d51e2c67417c2b153574d6dd3516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up privilege configuration.  <a href="privconfig_8h.html#a8638d51e2c67417c2b153574d6dd3516">More...</a><br /></td></tr>
<tr class="separator:a8638d51e2c67417c2b153574d6dd3516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58e85af5994d3950472e03371f52fe5"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#ad58e85af5994d3950472e03371f52fe5">privc_configured</a> (void)</td></tr>
<tr class="memdesc:ad58e85af5994d3950472e03371f52fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the user wants to drop privileges.  <a href="privconfig_8h.html#ad58e85af5994d3950472e03371f52fe5">More...</a><br /></td></tr>
<tr class="separator:ad58e85af5994d3950472e03371f52fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec53edb01e8fb02a1ab594f68d58fe8"><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="privconfig_8h.html#a2ec53edb01e8fb02a1ab594f68d58fe8">privc_become</a> (GError **err)</td></tr>
<tr class="memdesc:a2ec53edb01e8fb02a1ab594f68d58fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop privileges if necessary.  <a href="privconfig_8h.html#a2ec53edb01e8fb02a1ab594f68d58fe8">More...</a><br /></td></tr>
<tr class="separator:a2ec53edb01e8fb02a1ab594f68d58fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Airframe Privilege Configuration Support. </p>
<p>Supplies privilege dropping for post-root initialization reduction of privileges (e.g. for live packet capture applications) and the command line option processing necessary to use it. Use this when you want to drop privileges after doing one-time setup as root. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0e6c118216deb5345451bf0c9e63bf35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e6c118216deb5345451bf0c9e63bf35">&#9670;&nbsp;</a></span>PRIVC_ERROR_SETUP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRIVC_ERROR_SETUP&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Privconfig setup error. </p>
<p>Signifies that setup failed because of bad command line options. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4fef5cd302addbb6d031a526bca66103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fef5cd302addbb6d031a526bca66103">&#9670;&nbsp;</a></span>privc_add_option_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean privc_add_option_group </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="airopt_8h.html#ab416f9c421f4fc3f525e1742b4a13b6f">AirOptionCtx</a> *&#160;</td>
          <td class="paramname"><em>aoctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return an option group for privilege configuration. </p>
<p>This option group defines two options: &ndash;become-user (-U) to become a specified user by name, and &ndash;become-group to additionally specify a group to become (otherwise, drops privileges to the given user's default group.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aoctx</td><td>airframe option context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if successful, FALSE otherwise </dd></dl>

</div>
</div>
<a id="a2ec53edb01e8fb02a1ab594f68d58fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ec53edb01e8fb02a1ab594f68d58fe8">&#9670;&nbsp;</a></span>privc_become()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean privc_become </td>
          <td>(</td>
          <td class="paramtype">GError **&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drop privileges if necessary. </p>
<p>Returns TRUE if not running as root. Returns FALSE if running as root with no &ndash;become-user option with PRIVC_ERROR_NODROP, or if <a class="el" href="privconfig_8h.html#a2ec53edb01e8fb02a1ab594f68d58fe8" title="Drop privileges if necessary.">privc_become()</a> was already called succsssfully with PRIVC_ERROR_ALREADY. If for some reason a required privilege drop fails, returns FALSE with PRIVC_ERROR_FAILED.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">err</td><td>an error description </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success, FALSE otherwise </dd></dl>

</div>
</div>
<a id="ad58e85af5994d3950472e03371f52fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58e85af5994d3950472e03371f52fe5">&#9670;&nbsp;</a></span>privc_configured()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean privc_configured </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the user wants to drop privileges. </p>
<p>Use this to determine whether warn the user if the application will not call priv_become() due to some application-specific state.</p>
<dl class="section return"><dt>Returns</dt><dd>TRUE if &ndash;become-user supplied on command line. </dd></dl>

</div>
</div>
<a id="a8638d51e2c67417c2b153574d6dd3516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8638d51e2c67417c2b153574d6dd3516">&#9670;&nbsp;</a></span>privc_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean privc_setup </td>
          <td>(</td>
          <td class="paramtype">GError **&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up privilege configuration. </p>
<p>Call this after parsing an options context including a GOptionGroup returned from privc_option_group(). This sets up internal state used by the other privconfig calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">err</td><td>an error description </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success, FALSE otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- page-content -->
<!-- BEGIN NETSA-TOOLS FOOTER -->
<div class="page-footer">
<!-- INCLUDE THE FOOTER CONTENT -->
<!--#include virtual="/tools-page-footer.shtml" -->
<div class="copyright">
This library is part of the
<a href="http://tools.netsa.cert.org/">NetSA Security Suite</a>,
developed by the <a href="http://www.cert.org/">CERT</a>
<a href="http://www.cert.org/netsa/">NetSA</a> group<br />
at the <a href="http://www.sei.cmu.edu/">Software Engineering Institute</a>
at <a href="http://www.cmu.edu/">Carnegie Mellon University</a>.
<br />
<br />
&copy; 2006-2020 Carnegie Mellon University </div>
</div><!-- page-footer -->
<!-- END NETSA-TOOLS FOOTER -->
</body>
</html>
